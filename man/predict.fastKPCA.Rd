% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kpca.R
\name{predict.fastKPCA}
\alias{predict.fastKPCA}
\title{Predict method for fastKPCA objects}
\usage{
\method{predict}{fastKPCA}(object, newdata, ...)
}
\arguments{
\item{object}{A fitted object of class \code{fastKPCA}.}

\item{newdata}{A numeric matrix or data frame containing the new data points
(observations x features). Must have the same number of features as the training data.}

\item{...}{Additional arguments (currently ignored).}
}
\value{
A matrix containing the projections of the new data onto the principal components.
The number of columns corresponds to \code{n_components_returned} in the \code{object}.
}
\description{
Projects new data points onto the kernel principal components.
}
\details{
The projection is calculated as \eqn{K_{new, centered} \alpha}, where
\eqn{K_{new, centered}} is the kernel matrix between the new data and the
original training data, centered using the statistics from the training kernel matrix,
and \eqn{\alpha} are the scaled principal component vectors stored in \code{object$pcv}.

Centering formula for the new kernel matrix \eqn{K_{new}} (dimensions m x n):
\eqn{K_{new, centered} = K_{new} - \mathbf{1}_{m x n} diag(\frac{1}{n} \sum_{j=1}^n K_{:,j}) - diag(\frac{1}{n} \sum_{i=1}^n K_{new, i:}) \mathbf{1}_{m x n} + \mathbf{1}_{m x n} (\frac{1}{n^2} \sum_{i,j} K_{i,j})} \\
where \eqn{K} is the original training kernel matrix, \eqn{K_{new}} is the kernel matrix between \code{newdata} and \code{object$X_train},
\eqn{\mathbf{1}_{m x n}} is an m x n matrix of ones, and n is the number of training samples.
This formula is adapted from Scholkopf et al. (1998) and applied efficiently using saved summary statistics.
}
